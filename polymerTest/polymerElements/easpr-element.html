<link rel="import" href="../bower_components/polymer/polymer.html">
<script src="../jquery_webrtc/jq.js"></script>
<script src="../jquery_webrtc/simplewebrtc.js"></script>
<link href="../../easpr/bootstrap.min.css" rel="stylesheet">
<link href="../../easpr/demo.css" rel="stylesheet">
<script src="../../easpr/bootstrap.min.js"></script>
<polymer-element name="easpr-element">
  <template>
  
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    	<div class="container">
        	<div class="navbar-header">
        		
          		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            		<span class="sr-only">Toggle navigation</span>
            		<span class="icon-bar"></span>
            		<span class="icon-bar"></span>
            		<span class="icon-bar"></span>
          		</button>
          		<a class="navbar-brand" href="#">Easpr Demo</a>
        	</div>
        	<div class="navbar-collapse collapse">
          		<form class="navbar-form navbar-right" role="form">
            		<div class="form-group" id="roomNav">
              			<input type="text" placeholder="Room name" id="roomName" name="roomName" class="form-control">
            		</div>
            		<button type="button" id="joinBtn" class="btn btn-success" on-click="{{joinRoom}}">Join Room</button>
            		<div class="form-group">
              			<span id="roomSpan">RoomName</span>
            		</div>
          		</form>
        	</div><!--/.navbar-collapse -->
      	</div>
    </div>
    
	<div id="remotesVideos"></div>
	<video height="500" id="localVideo"></video>
  </template>

  <script>
  Polymer('easpr-element',{

  	ready:function(){
  		this.webrtc=new SimpleWebRTC({
	
			// the id/element dom element that will hold "our" video
			localVideoEl : 'localVideo',
			// the id/element dom element that will hold remote videos
			remoteVideosEl : 'remotesVideos',
			// immediately ask for camera access
			autoRequestMedia : true
			});
  	},

  	joinRoom:function(){
  		console.log("Click!");
			if ($('#roomName').val() != "") {
				 //console.log("got there");
				$('#remotesVideos').empty();

				var roomName = $('#roomName').val();
				$('#roomName').val("");

				$('#roomSpan').html(roomName);
				this.webrtc.joinRoom(roomName);

			} else {
				alert("Room name can't be empty");
			} 
  	}
  });
  </script>
</polymer-element>