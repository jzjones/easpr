<link rel="import" href="../bower_components/polymer/polymer.html">
<script src="../jquery_webrtc/rtc.js"></script>
<polymer-element name="webrtc-element" constructor="WebRTCElement">
<template> </template> <script>
Polymer('webrtc-element',{
	ready: function(){
      	this.connection.session = {audio: false, video: false, screen: false, data: false};
    },
    
    initialize: function(channelid, session){
    	this.connection = new RTCMultiConnection(channelid);
    	this.connection.session = session;
    	this.connection.join();
    },
    
    //sets sessionid
    setSessionId: function(sessionId){
    	this.connection.sessionid = sessionId;
    },
    
    //sets type of data for session to transmit
    setSessionType: function(session){
    	this.connection.session = session;
    },
    
    attemptJoin: function(roomId){
    	var socket = io.connect('/');

        socket.on('presence', function (isChannelPresent) {
            console.log('is channel present', isChannelPresent);
            if (!isChannelPresent) {
            	this.initiate(roomId);
            }
            else{
            	this.connection.join(roomId)
            }
        });

        socket.emit('presence', channel);
    },
      
    initiate: function(roomId){
      	this.connection.open({
    	  	sessionid: roomId,
    	  	session: this.session
    	});
    },

    join: function(roomId){
		this.connection.connect(roomId);
	    this.connection.join();
	    console.log(this.connection.channel);
    },
    
    test: function(){
    	console.log(this.connection);
    }
 });
  </script> </polymer-element>
