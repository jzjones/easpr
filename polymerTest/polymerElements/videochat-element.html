<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel='import' href='./webrtc-element.html'>
<script src="../jquery_webrtc/rtc.js"></script>

<polymer-element name="videochat-element" attributes="name sessionName" extends="webrtc-element" constructor='VideoChatElement'>
  <template>
    <div id='videoRow'></div>
  </template>

  <script>
  Polymer('videochat-element',{
       
    ready: function(){
      this.super();
      console.log('base connection on ready in Videoelement'+this.connection);
      var root=this.shadowRoot;
      
      this.connection.onstream = function(e){
      root.querySelector('#videoRow').appendChild(e.mediaElement) 
      };

      this.connection.onstreamended = function(e){
        if(e.mediaElement.parentNode) e.mediaElement.parentNode.removeChild(e.mediaElement);
      };
    },
    
    initialize: function(channelID){
    	this.super([channelID, {video: true, audio: true}]);
    	this.connection.sessionid = ("video_" + this.connection.channel);
    },
     
  });
  </script>
</polymer-element>
